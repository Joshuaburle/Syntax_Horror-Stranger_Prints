<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <title>Test Automatique - Jeu Horror</title>
    <style>
        body { 
            font-family: monospace; 
            background: #000; 
            color: #0f0; 
            padding: 20px;
            max-width: 800px;
            margin: 0 auto;
        }
        .test { 
            margin: 10px 0; 
            padding: 8px;
            border-left: 3px solid #333;
        }
        .pass { border-color: #0f0; }
        .fail { border-color: #f00; color: #f00; }
        .info { color: #0af; }
        h1 { color: #f90; }
        #iframe-container { 
            display: none; 
        }
    </style>
</head>
<body>
    <h1>ðŸ§ª Tests Automatiques du Jeu</h1>
    <div id="results"></div>
    <div id="iframe-container">
        <iframe id="game-frame" src="index.html" width="800" height="600"></iframe>
    </div>

    <script>
        const results = document.getElementById('results');
        
        function log(msg, type = 'info') {
            const div = document.createElement('div');
            div.className = `test ${type}`;
            div.textContent = `${type === 'pass' ? 'âœ“' : type === 'fail' ? 'âœ—' : 'â†’'} ${msg}`;
            results.appendChild(div);
        }

        async function runTests() {
            log('DÃ©marrage des tests...', 'info');
            
            // Test 1: Chargement du script
            log('Test 1: VÃ©rification du fichier script.js');
            try {
                const scriptResp = await fetch('script.js');
                const scriptText = await scriptResp.text();
                
                if (scriptText.includes('makeUkulele')) {
                    log('âœ“ Fonction makeUkulele trouvÃ©e', 'pass');
                } else {
                    log('âœ— Fonction makeUkulele manquante', 'fail');
                }
                
                if (scriptText.includes('flatShading: true')) {
                    log('âœ“ Style Risk of Rain 2 (flatShading) appliquÃ©', 'pass');
                } else {
                    log('âœ— Style RoR2 manquant', 'fail');
                }
                
                if (!scriptText.includes('dustCount')) {
                    log('âœ“ Particules de poussiÃ¨re retirÃ©es', 'pass');
                } else {
                    log('âœ— Particules toujours prÃ©sentes', 'fail');
                }
                
                if (scriptText.includes('sealedDoorZ - 0.3')) {
                    log('âœ“ Collision porte scellÃ©e implÃ©mentÃ©e', 'pass');
                } else {
                    log('âœ— Collision porte scellÃ©e manquante', 'fail');
                }
                
                if (scriptText.includes('startFight()')) {
                    log('âœ“ DÃ©clencheur de combat prÃ©sent', 'pass');
                } else {
                    log('âœ— Combat non dÃ©clenchÃ©', 'fail');
                }
                
                if (scriptText.includes('backLeftWall') && scriptText.includes('backRightWall')) {
                    log('âœ“ Murs latÃ©raux derriÃ¨re spawn ajoutÃ©s', 'pass');
                } else {
                    log('âœ— Murs latÃ©raux manquants', 'fail');
                }
                
                if (scriptText.includes('backCeiling')) {
                    log('âœ“ Plafond derriÃ¨re spawn ajoutÃ©', 'pass');
                } else {
                    log('âœ— Plafond derriÃ¨re spawn manquant', 'fail');
                }
                
                // VÃ©rifier que les textures utilisent corridorMat
                const backFloorMatch = scriptText.match(/backFloor.*?corridorMat/s);
                if (backFloorMatch) {
                    log('âœ“ Sol derriÃ¨re spawn utilise texture unifiÃ©e', 'pass');
                } else {
                    log('âœ— Sol derriÃ¨re spawn n\'utilise pas corridorMat', 'fail');
                }
                
            } catch (err) {
                log(`âœ— Erreur lors du chargement: ${err.message}`, 'fail');
            }
            
            // Test 2: HTML
            log('\nTest 2: VÃ©rification du fichier index.html');
            try {
                const htmlResp = await fetch('index.html');
                const htmlText = await htmlResp.text();
                
                if (htmlText.includes('fightWrap')) {
                    log('âœ“ Interface de combat prÃ©sente', 'pass');
                } else {
                    log('âœ— Interface de combat manquante', 'fail');
                }
            } catch (err) {
                log(`âœ— Erreur HTML: ${err.message}`, 'fail');
            }
            
            // Test 3: CSS
            log('\nTest 3: VÃ©rification du fichier style.css');
            try {
                const cssResp = await fetch('style.css');
                const cssText = await cssResp.text();
                
                if (cssText.includes('.fight-wrap')) {
                    log('âœ“ Styles de combat prÃ©sents', 'pass');
                } else {
                    log('âœ— Styles de combat manquants', 'fail');
                }
            } catch (err) {
                log(`âœ— Erreur CSS: ${err.message}`, 'fail');
            }
            
            log('\nâœ… Tests terminÃ©s!', 'pass');
            log('ðŸ‘‰ Ouvrez http://localhost:8000/game/index.html dans votre navigateur', 'info');
            log('ðŸ‘‰ Testez: collision porte, ramassage ukulÃ©lÃ©, dÃ©clenchement combat', 'info');
        }

        runTests();
    </script>
</body>
</html>
