#!/usr/bin/env python3

import tkinter as tk
from functools import partial
import tkinter as tk
from functools import partial
try:
    from PIL import Image, ImageTk
    HAS_PIL = True
except ImportError:
    HAS_PIL = False

def on_closing():
    text_var.set("> Vous ne pouvez pas quitter comme ça...")
    root.bell()  # Fait un son pour l'effet

STORY = {
    "start": {
        "text": "Tu te réveilles dans une pièce étrange. Que fais-tu ?",
        "choices": [("Explorer", "explore"), ("Attendre", "wait")],
    },
    "explore": {
        "text": "Tu trouves une porte et une fenêtre.",
        "choices": [("Ouvrir la porte", "door"), ("Regarder par la fenêtre", "window")],
    },
    "wait": {
        "text": "Rien ne se passe. Le temps passe.",
        "choices": [("Se lever", "explore"), ("S'endormir", "end_sleep")],
    },
    "door": {
        "text": "La porte est verrouillée.",
        "choices": [("Forcer la porte", "end_force"), ("Reculer", "start")],
    },
    "window": {
        "text": "Par la fenêtre, tu vois un jardin.",
        "choices": [("Grimper", "end_out"), ("Reculer", "start")],
    },
    "end_sleep": {"text": "Tu t'endors et te réveilles ailleurs. Fin.", "choices": []},
    "end_force": {"text": "Tu blesses ta main. Fin.", "choices": []},
    "end_out": {"text": "Tu sors dans le jardin et trouves la liberté. Fin.", "choices": []},
}

root = tk.Tk()
root.title("Terminal")
root.geometry("600x400")
root.configure(bg='black')
root.protocol("WM_DELETE_WINDOW", on_closing)  # Intercepte la croix

# Frame pour l'image en haut à gauche
image_frame = tk.Frame(root, bg='black')
image_frame.pack(anchor='nw', padx=20, pady=20)

# Chargement et affichage de l'image
if HAS_PIL:
    try:
        image = Image.open("images/votre_image.png")
        image = image.resize((100, 100))
        photo = ImageTk.PhotoImage(image)
        image_label = tk.Label(
            image_frame,
            image=photo,
            bg='black'
        )
        image_label.image = photo
        image_label.pack()
    except:
        placeholder = tk.Label(
            image_frame,
            text="[Image placeholder]",
            bg='black',
            fg='#00ff00',
            font=('Courier', 10)
        )
        placeholder.pack()
else:
    print("PIL non installé - fonctionnement sans images")

# Style terminal (texte)
text_var = tk.StringVar()
text_label = tk.Label(
    root, 
    textvariable=text_var, 
    wraplength=540,
    justify="left",
    padx=20,
    pady=20,
    bg='black',
    fg='#00ff00',
    font=('Courier', 12)
)
text_label.pack(fill="both", expand=True)